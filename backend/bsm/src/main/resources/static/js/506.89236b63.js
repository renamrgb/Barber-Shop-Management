"use strict";(self["webpackChunkbsm"]=self["webpackChunkbsm"]||[]).push([[506],{9068:(e,s,r)=>{r.d(s,{Z:()=>t});var a=r(1505);class t{url="/customers";async consultarTodos(){try{const e=await a.Z.get(this.url);return e.data}catch(e){return e}}async cadastrar(e){try{const s=await a.Z.post(this.url,this.replaceItem(e));return s}catch(s){return s}}async excluir(e){try{const s=await a.Z["delete"](`${this.url}/${e}`);return s}catch(s){return s}}async alterar(e,s){console.log(`${JSON.stringify(s)}`);try{const r=await a.Z.put(`${this.url}/${e}`,this.replaceItem(s));return r}catch(r){return console.log(r),r}}async buscarUm(e){try{const s=await a.Z.get(`${this.url}/${e}`);return s.data}catch(s){return s}}async findByName(e){try{const s=await a.Z.get(`${this.url}?name=${e}`);return s.data}catch(s){return s}}async getAllPaged(e){try{const s=await a.Z.get(`${this.url}/paged?page=${e}`);return s.data}catch(s){return s}}async getByNamePaged(e,s){try{const r=await a.Z.get(`${this.url}/paged?name=${e}&page=${s}`);return r.data}catch(r){return r}}replaceItem(e){return e.user.phoneNumber=e.user.phoneNumber.replace(/[^\d]+/g,""),e.user.document=e.user.document.replace(/[^\d]+/g,""),e.user.rg=e.user.rg.replace(/[^\d]+/g,""),void 0!=e.user.address.zipCode&&(e.user.address.zipCode=e.user.address.zipCode.replace(/[^\d]+/g,"")),e}}},1466:(e,s,r)=>{r.d(s,{Z:()=>t});var a=r(1505);class t{url="/parameters";async getParamerter(){try{const e=await a.Z.get(`${this.url}/1`);return e.data}catch(e){return e}}async save(e){try{const s=await a.Z.put(`${this.url}/1`,e);return s.data}catch(s){return s}}async consultWorkSchedules(){try{const e=await a.Z.get(`${this.url}/1`);return e.data.parameterValues}catch(e){return e}}async getMaxPointsCard(){try{const e=await a.Z.get(`${this.url}/1`),s=e.data.parameterValues;for(let r of s)if("QTY_LOYALYTY_CARD"==r.parameter_key)return parseInt(r.parameter_value)}catch(e){return e}}async getParamerterKey(e){try{const s=await a.Z.get(`${this.url}/findByKey?pameterKey=${e}`);return s.data}catch(s){return s}}}},7693:(e,s,r)=>{r.d(s,{Z:()=>v});var a=r(3396);const t={class:"row mb-3"},o={class:"col"},i={class:"col"},n={class:"row mb-3",style:{"text-align":"center"}},l={class:"col"},d={class:"col"},u={key:0,class:"row mb-3"},m={class:"col",style:{"text-align":"center"}};function c(e,s,r,c,p,h){const f=(0,a.up)("CButton"),g=(0,a.up)("CModalTitle"),w=(0,a.up)("CModalHeader"),y=(0,a.up)("CFormLabel"),v=(0,a.up)("CFormInput"),$=(0,a.up)("CModalBody"),C=(0,a.up)("CModalFooter"),U=(0,a.up)("CModal"),b=(0,a.up)("toast");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(f,{color:"secondary",variant:"outline",onClick:s[0]||(s[0]=()=>{p.visibleLiveDemo=!0})},{default:(0,a.w5)((()=>[(0,a.Uk)("Cartela de fidelidade")])),_:1}),(0,a.Wm)(U,{visible:p.visibleLiveDemo,onClose:s[4]||(s[4]=()=>{p.visibleLiveDemo=!1})},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Cartela de fidelidade")])),_:1})])),_:1}),(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a._)("div",t,[(0,a._)("div",o,[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Qtde de pontos")])),_:1}),(0,a.Wm)(v,{modelValue:r.card.points,"onUpdate:modelValue":s[1]||(s[1]=e=>r.card.points=e),disabled:!0},null,8,["modelValue"])]),(0,a._)("div",i,[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Qtde usos")])),_:1}),(0,a.Wm)(v,{modelValue:r.card.quantityUsed,"onUpdate:modelValue":s[2]||(s[2]=e=>r.card.quantityUsed=e),disabled:!0},null,8,["modelValue"])])]),(0,a._)("div",n,[(0,a._)("div",l,[(0,a.Wm)(f,{color:"link",shape:"rounded-0",onClick:h.resetCard},{default:(0,a.w5)((()=>[(0,a.Uk)("Zerar cartela")])),_:1},8,["onClick"])]),(0,a._)("div",d,[(0,a.Wm)(f,{color:"link",shape:"rounded-0",onClick:h.addPoints},{default:(0,a.w5)((()=>[(0,a.Uk)("Adicionar >>")])),_:1},8,["onClick"])])]),r.card.points==p.maxPoints?((0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("div",m,[(0,a.Wm)(f,{color:"link",shape:"rounded-0",onClick:h.applyDiscount},{default:(0,a.w5)((()=>[(0,a.Uk)("Aplicar desconto")])),_:1},8,["onClick"])])])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{color:"secondary",onClick:s[3]||(s[3]=()=>{p.visibleLiveDemo=!1})},{default:(0,a.w5)((()=>[(0,a.Uk)(" Fechar ")])),_:1})])),_:1})])),_:1},8,["visible"]),(0,a.Wm)(b,{ref:"toast"},null,512)],64)}var p=r(6947),h=r(1466),f=r(5066);const g={components:{CFormInput:p.jO,CFormLabel:p.L8,Toast:f.Z},name:"LoyaltyCard",props:{card:{type:Object,required:!0}},data(){return{visibleLiveDemo:!1,parameterService:new h.Z,maxPoints:0}},methods:{addPoints(){this.card.points<this.maxPoints?this.card.points=parseInt(this.card.points+1):this.$refs.toast.createToastDanger(`Os pontos não pode ser maior que ${this.maxPoints}`)},async getMaxPoints(){this.maxPoints=await this.parameterService.getMaxPointsCard()},resetCard(){this.card.points=0},async applyDiscount(){if(this.card.points==this.maxPoints){const e=await this.parameterService.getParamerterKey("DISCOUNT_LOYALYTY_CARD");this.$emit("apply-discount",parseFloat(e.parameter_value)),this.visibleLiveDemo=!1}else this.$refs.toast.createToastDanger(`Você só pode aplicar o desconto quando a quantidade de pontos for igual a ${this.maxPoints}`)}},mounted(){this.getMaxPoints()}};var w=r(89);const y=(0,w.Z)(g,[["render",c]]),v=y},2506:(e,s,r)=>{r.r(s),r.d(s,{default:()=>D});var a=r(3396),t=r(7139),o=r(9242);const i=(0,a._)("strong",null,"Clientes",-1),n={class:"mb-3"},l={key:0,class:"invalid-input-form"},d={class:"mb-3"},u={key:0,class:"invalid-input-form"},m={class:"row mb-3"},c={class:"row mb-3"},p={class:"mb-3"},h={key:0,class:"invalid-input-form"},f={key:0,class:"row mb-3"},g={class:"col"},w={class:"mb-3"},y=(0,a._)("br",null,null,-1),v={class:"d-grid gap-2 d-md-flex justify-content-md-end"},$=(0,a._)("a",{href:"/#/forms/cliente",class:"btn btn-danger"},"Cancelar",-1);function C(e,s,r,C,U,b){const _=(0,a.up)("CCardHeader"),k=(0,a.up)("CFormLabel"),P=(0,a.up)("CFormInput"),F=(0,a.up)("PasswordForUserVue"),W=(0,a.up)("DocumentForUser"),Z=(0,a.up)("AddressForUser"),x=(0,a.up)("LoyaltyCard"),L=(0,a.up)("CFormSwitch"),M=(0,a.up)("CButton"),D=(0,a.up)("CForm"),V=(0,a.up)("CCardBody"),q=(0,a.up)("CCard"),A=(0,a.up)("CCol"),N=(0,a.up)("CRow"),S=(0,a.up)("toast"),T=(0,a.Q2)("mask");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(N,null,{default:(0,a.w5)((()=>[(0,a.Wm)(A,{xs:12},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{class:"mb-4"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[i])),_:1}),(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Wm)(k,{for:"nome"},{default:(0,a.w5)((()=>[(0,a.Uk)("* Nome")])),_:1}),(0,a.Wm)(P,{name:"nome",type:"text",placeholder:"",modelValue:U.form.user.name,"onUpdate:modelValue":s[0]||(s[0]=e=>U.form.user.name=e)},null,8,["modelValue"]),U.v$.form.user.name.$errors.length>0?((0,a.wg)(),(0,a.iD)("div",l,(0,t.zw)(U.v$.form.user.name.$errors[0].$message),1)):(0,a.kq)("",!0)]),(0,a._)("div",d,[(0,a.Wm)(k,{for:"email"},{default:(0,a.w5)((()=>[(0,a.Uk)("* E-mail")])),_:1}),(0,a.Wm)(P,{name:"email",type:"email",placeholder:"exemplo@gmail.com",modelValue:U.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=e=>U.form.user.email=e)},null,8,["modelValue"]),U.v$.form.user.email.$errors.length>0?((0,a.wg)(),(0,a.iD)("div",u,(0,t.zw)(U.v$.form.user.email.$errors[0].$message),1)):(0,a.kq)("",!0)]),(0,a._)("div",m,[(0,a.Wm)(F,{passwordProps:this.form.user.password,ref:"passwordForUser"},null,8,["passwordProps"])]),(0,a._)("div",c,[(0,a.Wm)(W,{ref:"documentForUser",typePersonProps:this.form.user.typePerson,documentProps:this.form.user.document,rgProps:this.form.user.rg},null,8,["typePersonProps","documentProps","rgProps"])]),(0,a._)("div",p,[(0,a.Wm)(k,{for:"telefone"},{default:(0,a.w5)((()=>[(0,a.Uk)("* Telefone / Celular")])),_:1}),(0,a.wy)((0,a._)("input",{name:"telefone",type:"tel",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=e=>U.form.user.phoneNumber=e)},null,512),[[T,["(##) #####-####"]],[o.nr,U.form.user.phoneNumber]]),U.v$.form.user.phoneNumber.$errors.length>0?((0,a.wg)(),(0,a.iD)("div",h,(0,t.zw)(U.v$.form.user.phoneNumber.$errors[0].$message),1)):(0,a.kq)("",!0)]),(0,a.Wm)(Z,{ref:"addressForUser"},null,512),void 0!=U.form.loyaltyCard?((0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",g,[(0,a.Wm)(x,{card:U.form.loyaltyCard},null,8,["card"])])])):(0,a.kq)("",!0),(0,a._)("div",w,[y,(0,a.Wm)(L,{name:"formSwitchCheckDefault",label:"Ativo",modelValue:U.form.user.isActive,"onUpdate:modelValue":s[3]||(s[3]=e=>U.form.user.isActive=e)},null,8,["modelValue"])]),(0,a._)("div",v,[(0,a.Wm)(M,{color:"primary",class:"me-md-2",onClick:b.submitForm},{default:(0,a.w5)((()=>[(0,a.Uk)("Confirmar")])),_:1},8,["onClick"]),$])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(S,{ref:"toast"},null,512)],64)}var U=r(3053),b=r(7829),_=r(9068),k=r(5066),P=r(9229),F=r(1299),W=r(9367),Z=r(7693);const x={components:{Toast:k.Z,DocumentForUser:P.Z,AddressForUser:F.Z,PasswordForUserVue:W.Z,LoyaltyCard:Z.Z},name:"Cliente",data(){return{v$:(0,U.Xw)(),validationsMessage:new b.Z,id:this.$route.params.id,service:new _.Z,form:{user:{name:"",email:"",password:"",phoneNumber:"",typePerson:"",document:"",rg:"",address:{zipCode:"",publicPlace:"",neighborhood:"",complement:"",city:"",state:""},nivelAcesso:{authority:"ROLE_USER"},isActive:!1}}}},validations(){return{form:{user:{name:{required:this.validationsMessage.requiredMessage,maxLength:this.validationsMessage.maxLengthMenssage(100)},email:{required:this.validationsMessage.requiredMessage,maxLength:this.validationsMessage.maxLengthMenssage(100),email:this.validationsMessage.emailMessage},phoneNumber:{required:this.validationsMessage.requiredMessage,maxLength:this.validationsMessage.maxLengthMenssage(15)}}}}},methods:{submitForm(){this.$refs.passwordForUser.setPasswordNotUpdate(),this.v$.$validate(),this.v$.$error||this.$refs.passwordForUser.btnChangePassword||!this.$refs.passwordForUser.isValid()?!this.v$.$error&&this.$refs.passwordForUser.btnChangePassword&&this.salvar():this.salvar()},async salvar(){let e;if(this.form.user.document=this.$refs.documentForUser.document,this.form.user.rg=this.$refs.documentForUser.rg,this.form.user.typePerson=this.$refs.documentForUser.typePerson,this.form.user.address=this.$refs.addressForUser.address,this.form.user.password=this.$refs.passwordForUser.password,void 0==this.id?e=await this.service.cadastrar(this.form):(this.form.password="",e=await this.service.alterar(this.id,this.form)),201==e.status)this.$refs.toast.createToast("Cadastrado com sucesso!"),this.$router.push("/forms/cliente");else if(200==e.status)this.$refs.toast.createToast("Alterado com sucesso!");else{let s=e.response.data.fieldErrors;s.forEach((e=>{this.$refs.toast.createToast(` [${e.fieldName}] ${e.message} `)}))}},async consultarUm(){void 0!=this.id&&(this.form.user=await this.service.buscarUm(this.id),this.form.loyaltyCard=this.form.user.loyaltyCard,this.$refs.documentForUser.document=this.form.user.document,this.$refs.documentForUser.rg=this.form.user.rg,this.$refs.documentForUser.typePerson=this.form.user.typePerson,this.$refs.addressForUser.address=this.form.user.address,this.$refs.addressForUser.change=!0,this.$refs.passwordForUser.password=this.form.user.password)},mostrarSenha(){0==this.mostraSenha?(document.getElementById("senha").type="text",document.getElementById("confirmaSenha").type="text"):(document.getElementById("senha").type="password",document.getElementById("confirmaSenha").type="password")},compararSenhas(){return this.form.user.password==this.form.user.confirmPassword||(this.messagePassword="As senhas não são iguais.",!1)}},mounted(){void 0!=this.id&&(this.consultarUm(),this.$refs.passwordForUser.btnChangePassword=!0)}};var L=r(89);const M=(0,L.Z)(x,[["render",C]]),D=M}}]);
//# sourceMappingURL=506.89236b63.js.map