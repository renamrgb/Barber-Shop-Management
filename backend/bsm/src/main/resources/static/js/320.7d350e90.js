"use strict";(self["webpackChunkbsm"]=self["webpackChunkbsm"]||[]).push([[320],{964:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(1505);class o{url="/products";async updateOrInsert(e,t){return void 0==e?await this.cadastrar(t):await this.alterar(e,t)}async consultarTodos(){try{const e=await s.Z.get(this.url);return e.data}catch(e){return e}}async getAllPaged(e,t){let a=`?page=${e}`;t&&(a=`?isActive=true&page=${e}`);try{const e=await s.Z.get(`${this.url}/productsPaged${a}`);return e.data}catch(o){return o}}async cadastrar(e){try{const t=await s.Z.post(this.url,e);return t}catch(t){return t}}async excluir(e){try{const t=await s.Z["delete"](`${this.url}/${e}`);return t}catch(t){return t}}async alterar(e,t){try{const a=await s.Z.put(`${this.url}/${e}`,t);return a}catch(a){return a}}async buscarUm(e){try{const t=await s.Z.get(`${this.url}/${e}`);return t.data}catch(t){return t}}async getByTitle(e){try{const t=await s.Z.get(`${this.url}?title=${e}`);return t.data}catch(t){return t}}async getByTitlePaged(e,t,a){let o="";a&&(o="&isActive=true");try{const a=await s.Z.get(`${this.url}/productsPaged?title=${e}${o}&page=${t}`);return a.data}catch(l){return l}}}},5691:(e,t,a)=>{a.d(t,{Z:()=>s});class s{agora=(new Date).toLocaleString("pt-BR",{timeZone:"America/Sao_Paulo"});dateNowISO(){const[e,t,a]=this.agora.split(/[\/\s,:]+/),s=`${a}-${t.padStart(2,"0")}-${e.padStart(2,"0")}`;return s}date(e,t,a){return"+"==a?e.setDate(e.getDate()+t):e.setDate(e.getDate()-t),this.formatDateISO(e.toLocaleString())}formatDateISO(e){const[t,a,s]=e.split(/[\/\s,:]+/),o=`${s}-${a.padStart(2,"0")}-${t.padStart(2,"0")}`;return o}compareDates(e){const t=new Date(e),a=new Date(this.formatDateISO(this.agora)),s=a.getTime()-t.getTime(),o=864e5,l=Math.floor(s/o);return l}}},7316:(e,t,a)=>{a.d(t,{Z:()=>d});var s=a(3396);function o(e,t,a,o,l,r){const i=(0,s.up)("CIcon"),u=(0,s.up)("CModalTitle"),d=(0,s.up)("CModalHeader"),n=(0,s.up)("CModalBody"),c=(0,s.up)("CButton"),m=(0,s.up)("CModalFooter"),p=(0,s.up)("CModal"),f=(0,s.up)("toast");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("td",null,[1==l.isActive?((0,s.wg)(),(0,s.j4)(i,{key:0,icon:"cil-check",size:"xl"})):0==l.isActive?((0,s.wg)(),(0,s.j4)(i,{key:1,icon:"cil-x-circle",size:"xl"})):(0,s.kq)("",!0)]),(0,s._)("td",null,[(0,s.Wm)(i,{icon:"cil-trash",size:"xl",onClick:t[0]||(t[0]=()=>{l.modalExcluir=!0,e.idItem=e.id})}),(0,s.Wm)(i,{icon:"cil-pencil",size:"xl",onClick:t[1]||(t[1]=t=>this.alterar(e.id))})]),(0,s.Wm)(p,{visible:l.modalExcluir,onClose:t[4]||(t[4]=()=>{l.modalExcluir=!1})},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{dismiss:"",onClose:t[2]||(t[2]=()=>{l.modalExcluir=!1})},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Deseja excluir esse item?")])),_:1})])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Uk)("O item será excluído permanentemente do banco de dados.")])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{color:"secondary",onClick:t[3]||(t[3]=()=>{l.modalExcluir=!1})},{default:(0,s.w5)((()=>[(0,s.Uk)("Cancelar")])),_:1}),(0,s.Wm)(c,{color:"primary",onClick:this.excluir},{default:(0,s.w5)((()=>[(0,s.Uk)("Confirmar")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["visible"]),(0,s.Wm)(f,{ref:"toast"},null,512)],64)}var l=a(5066);const r={components:{Toast:l.Z},name:"IconsTdTable",props:{isActiveProps:Boolean,idItemProps:Number,serviceProps:Object},data(){return{isActive:this.isActiveProps,modalExcluir:!1,service:this.serviceProps}},computed:{},methods:{async excluir(){if(this.modalExcluir=!1,void 0!=this.idItemProps){let e=await this.service.excluir(this.idItemProps);204==e.status?(this.$refs.toast.createToast("Excluído com sucesso!"),this.$emit("get-all")):this.$refs.toast.createToast("Ocorreu um erro ao excluir item!")}},alterar(){this.$emit("alterar-item",this.idItemProps)}}};var i=a(89);const u=(0,i.Z)(r,[["render",o]]),d=u},2362:(e,t,a)=>{a.d(t,{Z:()=>b});var s=a(3396),o=a(7139);const l={key:0},r={class:"pagination"},i={class:"page-item"},u=(0,s._)("span",{"aria-hidden":"true"},"«",-1),d=[u],n=["onClick"],c={class:"page-item"},m=(0,s._)("span",{"aria-hidden":"true"},"»",-1),p=[m];function f(e,t,a,u,m,f){return m.totalPages>0?((0,s.wg)(),(0,s.iD)("nav",l,[(0,s._)("ul",r,[(0,s._)("li",i,[(0,s._)("a",{class:"page-link",onClick:t[0]||(t[0]=e=>f.previous()),"aria-label":"Previous"},d)]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.totalPages,(e=>((0,s.wg)(),(0,s.iD)("li",{class:(0,o.C_)([{active:f.isActive(e)},"page-item"]),key:e},[(0,s._)("a",{class:"page-link",onClick:t=>f.setNumberPage(e)},(0,o.zw)(e),9,n)],2)))),128)),(0,s._)("li",c,[(0,s._)("a",{class:"page-link",onClick:t[1]||(t[1]=e=>f.next()),"aria-label":"Next"},p)])])])):(0,s.kq)("",!0)}const g={name:"NextPageTable",props:{pageId:{type:Number,required:!0}},data(){return{page:this.pageId,totalPages:0,totalElements:0,last:!1,pageable:{pageNumber:0,pageSize:0}}},methods:{isActive(e){return e-1==this.pageable.pageNumber},setNumberPage(e){this.pageable.pageNumber=e-1,this.$emit("update-pageId",this.pageable.pageNumber)},previous(){0!=this.pageable.pageNumber&&(this.pageable.pageNumber=this.pageable.pageNumber-1,this.$emit("update-pageId",this.pageable.pageNumber))},next(){this.pageable.pageNumber<this.totalPages-1&&(this.pageable.pageNumber=this.pageable.pageNumber+1,this.$emit("update-pageId",this.pageable.pageNumber))}}};var h=a(89);const w=(0,h.Z)(g,[["render",f]]),b=w},5066:(e,t,a)=>{a.d(t,{Z:()=>d});var s=a(3396),o=a(7139);function l(e,t,a,l,r,i){const u=(0,s.up)("CToastBody"),d=(0,s.up)("CToast"),n=(0,s.up)("CToaster");return(0,s.wg)(),(0,s.j4)(n,{placement:"top-end"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.toasts,((e,t)=>((0,s.wg)(),(0,s.j4)(d,{key:t,color:r.color},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s._)("b",null,(0,o.zw)(e.content),1)])),_:2},1024)])),_:2},1032,["color"])))),128))])),_:1})}const r={data(){return{toasts:[],color:"info"}},methods:{createToast(e){this.color="light",this.toasts.push({content:e})},createToastDanger(e){this.color="danger",this.toasts.push({content:e})},createToastWarning(e){this.color="warning",this.toasts.push({content:e})}}};var i=a(89);const u=(0,i.Z)(r,[["render",l]]),d=u},8320:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var s=a(3396),o=a(9242),l=a(7139);const r=e=>((0,s.dD)("data-v-6bc9796f"),e=e(),(0,s.Cn)(),e),i=r((()=>(0,s._)("h3",null,"Produtos",-1))),u={class:"row"},d={class:"col-md-12 mx-auto"},n={class:"input-group"},c={class:"input-group-append"},m={class:"row"},p={class:"col-md-12 mx-auto"},f=r((()=>(0,s._)("br",null,null,-1))),g={class:"bdr"};function h(e,t,a,r,h,w){const b=(0,s.up)("CCol"),v=(0,s.up)("CIcon"),_=(0,s.up)("router-link"),W=(0,s.up)("CRow"),y=(0,s.up)("CCardHeader"),k=(0,s.up)("CFormSwitch"),C=(0,s.up)("CTableHeaderCell"),T=(0,s.up)("CTableRow"),x=(0,s.up)("CTableHead"),$=(0,s.up)("CTableDataCell"),P=(0,s.up)("IconsTdTable"),I=(0,s.up)("CButton"),U=(0,s.up)("CTableBody"),D=(0,s.up)("CTable"),N=(0,s.up)("NextPageTable"),V=(0,s.up)("CCardBody"),Z=(0,s.up)("CCard"),A=(0,s.up)("toast"),S=(0,s.up)("ModalStockWriteOffVue");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{xs:12},{default:(0,s.w5)((()=>[(0,s.Wm)(Z,{class:"mb-4"},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(W,{class:"align-items-start"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[i])),_:1}),(0,s.Wm)(b,{id:"teste-align"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{to:"/forms/produto/cadastro"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{icon:"cil-playlist-add",size:"xxl"})])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(V,null,{default:(0,s.w5)((()=>[(0,s._)("div",u,[(0,s._)("div",d,[(0,s._)("div",n,[(0,s.wy)((0,s._)("input",{class:"form-control border-end-0 border rounded-pill",type:"search",placeholder:"Buscar",id:"example-search-input","onUpdate:modelValue":t[0]||(t[0]=e=>h.searchText=e)},null,512),[[o.nr,h.searchText]]),(0,s._)("span",c,[(0,s._)("button",{class:"btn btn-outline-secondary bg-dark border-bottom-0 border rounded-pill ms-n5",type:"button",onClick:t[1]||(t[1]=(...e)=>w.getByTitle&&w.getByTitle(...e))},[(0,s.Wm)(v,{icon:"cil-magnifying-glass",size:"x"})])])])])]),(0,s._)("div",m,[(0,s._)("div",p,[f,(0,s.Wm)(k,{id:"formSwitchCheckDefault",label:"Apenas ativos",modelValue:h.findAssets,"onUpdate:modelValue":t[2]||(t[2]=e=>h.findAssets=e)},null,8,["modelValue"])])]),(0,s._)("div",g,[(0,s.Wm)(D,{responsive:"xl"},{default:(0,s.w5)((()=>[(0,s.Wm)(x,{color:"dark"},{default:(0,s.w5)((()=>[(0,s.Wm)(T,null,{default:(0,s.w5)((()=>[(0,s.Wm)(C,{scope:"col"},{default:(0,s.w5)((()=>[(0,s.Uk)("#")])),_:1}),(0,s.Wm)(C,{scope:"col"},{default:(0,s.w5)((()=>[(0,s.Uk)("Título")])),_:1}),(0,s.Wm)(C,{scope:"col"},{default:(0,s.w5)((()=>[(0,s.Uk)("Valor")])),_:1}),(0,s.Wm)(C,{scope:"col"},{default:(0,s.w5)((()=>[(0,s.Uk)("Qtde Disponível")])),_:1}),(0,s.Wm)(C,{scope:"col"},{default:(0,s.w5)((()=>[(0,s.Uk)("Ativo")])),_:1}),(0,s.Wm)(C,{scope:"col",colspan:"3"})])),_:1})])),_:1}),(0,s.Wm)(U,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.itens,(e=>((0,s.wg)(),(0,s.j4)(T,{key:e.id},{default:(0,s.w5)((()=>[(0,s.Wm)(C,{scope:"row"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.id),1)])),_:2},1024),(0,s.Wm)($,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.title),1)])),_:2},1024),(0,s.Wm)($,null,{default:(0,s.w5)((()=>[(0,s.Uk)("R$ "+(0,l.zw)(e.price.toFixed(2)),1)])),_:2},1024),(0,s.Wm)($,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.quantity),1)])),_:2},1024),(0,s.Wm)(P,{isActiveProps:e.isActive,"id-item-props":e.id,serviceProps:h.service,onGetAll:w.consultaTodos,onAlterarItem:w.alterar},null,8,["isActiveProps","id-item-props","serviceProps","onGetAll","onAlterarItem"]),(0,s.Wm)($,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{color:"light",onClick:t=>w.modalStockWriteOff(e.id)},{default:(0,s.w5)((()=>[(0,s.Uk)("Baixar produto")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,s.Wm)(N,{ref:"nextPageTable","page-id":h.pageId,onUpdatePageId:w.updatePageId},null,8,["page-id","onUpdatePageId"])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(A,{ref:"toast"},null,512),(0,s.Wm)(S,{ref:"modalStockWriteOffVue",onRefreshList:w.refreshList},null,8,["onRefreshList"])],64)}var w=a(964),b=a(5066),v=a(2362),_=a(7316),W=a(6947);const y={class:"row mb-3"},k={class:"col"},C={class:"row mb-3"},T={class:"col-4"},x={class:"col-4"},$={class:"col-4"},P={class:"row mb-3"},I={class:"col"},U={class:"col"},D={class:"row mb-3"},N={class:"col"};function V(e,t,a,o,r,i){const u=(0,s.up)("CModalTitle"),d=(0,s.up)("CModalHeader"),n=(0,s.up)("CFormLabel"),c=(0,s.up)("CFormInput"),m=(0,s.up)("CInputGroupText"),p=(0,s.up)("CInputGroup"),f=(0,s.up)("CFormTextarea"),g=(0,s.up)("CModalBody"),h=(0,s.up)("CButton"),w=(0,s.up)("CModalFooter"),b=(0,s.up)("CModal"),v=(0,s.up)("toast");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(b,{size:"lg",visible:r.visibleLiveDemo,onClose:t[8]||(t[8]=()=>{r.visibleLiveDemo=!1})},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" #"+(0,l.zw)(r.id)+" Baixar produto em estoque",1)])),_:1})])),_:1}),(0,s.Wm)(g,null,{default:(0,s.w5)((()=>[(0,s._)("div",y,[(0,s._)("div",k,[(0,s.Wm)(n,{for:"nome"},{default:(0,s.w5)((()=>[(0,s.Uk)("Título do produto")])),_:1}),(0,s.Wm)(c,{name:"Data da compra",type:"text",modelValue:r.form.product.title,"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.product.title=e),disabled:!0},null,8,["modelValue"])])]),(0,s._)("div",C,[(0,s._)("div",T,[(0,s.Wm)(n,{for:"nome"},{default:(0,s.w5)((()=>[(0,s.Uk)("Preço")])),_:1}),(0,s.Wm)(p,{class:"mb-1"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)("R$")])),_:1}),(0,s.Wm)(c,{modelValue:r.form.product.price,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.product.price=e),disabled:!0},null,8,["modelValue"])])),_:1})]),(0,s._)("div",x,[(0,s.Wm)(n,{for:"qtyProduct"},{default:(0,s.w5)((()=>[(0,s.Uk)("* Qtde disponível")])),_:1}),(0,s.Wm)(c,{name:"qtyProduct",type:"number",modelValue:r.form.product.quantity,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.product.quantity=e),disabled:!0},null,8,["modelValue"])]),(0,s._)("div",$,[(0,s.Wm)(n,{for:"quantidade"},{default:(0,s.w5)((()=>[(0,s.Uk)("* Qtde a ser baixada")])),_:1}),(0,s.Wm)(c,{name:"quantidade",type:"number",modelValue:r.form.qty,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.qty=e),disabled:!1},null,8,["modelValue"])])]),(0,s._)("div",P,[(0,s._)("div",I,[(0,s.Wm)(n,{for:"registro"},{default:(0,s.w5)((()=>[(0,s.Uk)("Registro")])),_:1}),(0,s.Wm)(c,{name:"registro",type:"date",modelValue:r.form.record,"onUpdate:modelValue":t[4]||(t[4]=e=>r.form.record=e),disabled:!0},null,8,["modelValue"])]),(0,s._)("div",U,[(0,s.Wm)(n,{for:"UserName"},{default:(0,s.w5)((()=>[(0,s.Uk)("Usuário da baixa")])),_:1}),(0,s.Wm)(c,{name:"UserName",type:"text",modelValue:r.form.user.name,"onUpdate:modelValue":t[5]||(t[5]=e=>r.form.user.name=e),disabled:!0},null,8,["modelValue"])])]),(0,s._)("div",D,[(0,s._)("div",N,[(0,s.Wm)(n,{for:"UserName"},{default:(0,s.w5)((()=>[(0,s.Uk)("* Motivo da baixa")])),_:1}),(0,s.Wm)(f,{max:"255",modelValue:r.form.reason,"onUpdate:modelValue":t[6]||(t[6]=e=>r.form.reason=e),rows:"3",text:"Deve ter até 255 caracteres"},null,8,["modelValue"])])])])),_:1}),(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h,{color:"secondary",onClick:t[7]||(t[7]=()=>{r.visibleLiveDemo=!1})},{default:(0,s.w5)((()=>[(0,s.Uk)(" Fechar ")])),_:1}),(0,s.Wm)(h,{color:"primary",onClick:i.formValidation},{default:(0,s.w5)((()=>[(0,s.Uk)("Confirmar")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["visible"]),(0,s.Wm)(v,{ref:"toast"},null,512)],64)}var Z=a(5691),A=a(1505);class S{url="/stockWriteOff";async save(e){try{const t=await A.Z.post(`${this.url}`,e);return t}catch(t){return t}}}const B={components:{Toast:b.Z},data(){return{service:new w.Z,stockWriteOffService:new S,visibleLiveDemo:!1,id:"",dateNow:new Z.Z,form:{product:{id:"",title:"",price:"",quantity:""},qty:0,record:"",reason:"",user:{id:localStorage.getItem("userId"),name:localStorage.getItem("nome_usuario")}}}},methods:{formValidation(){let e=!0;this.form.qty<=0&&(this.$refs.toast.createToastDanger("Quantidade deve ser maior que 0"),e=!1),""==this.form.reason&&(this.$refs.toast.createToastDanger("Descrição é obrigatória"),e=!1),this.form.reason.length>=255&&(this.$refs.toast.createToastDanger("O motivo deve conter até 255 caracteres"),e=!1),e&&this.save()},async getById(e){let t=await this.service.buscarUm(e);this.form.product=t},setDateNow(){this.form.record=this.dateNow.dateNowISO()},async save(){this.form.product.id=this.id;let e=await this.stockWriteOffService.save(this.form);console.log(e.response),201==e.status?(this.$refs.toast.createToast("Baixa registrada com sucesso"),this.$router.push("/forms/produto"),this.visibleLiveDemo=!1,this.form.qty=0,this.form.reason="",this.$emit("refreshList")):400==e.response.status?this.$refs.toast.createToastDanger(e.response.data.message):this.$refs.toast.createToastDanger("Ocorreu um erro ao realizar baixa")}},beforeUpdate(){""!=this.id&&this.visibleLiveDemo&&(this.getById(this.id),this.setDateNow())}};var O=a(89);const q=(0,O.Z)(B,[["render",V]]),z=q,E={components:{Toast:b.Z,NextPageTable:v.Z,IconsTdTable:_.Z,CButton:W.u5,ModalStockWriteOffVue:z},name:"Produto",data(){return{service:new w.Z,itens:"",modalExcluir:!1,idItem:"",searchText:"",pageId:0,findAssets:!1}},methods:{modalStockWriteOff(e){this.$refs.modalStockWriteOffVue.visibleLiveDemo=!0,this.$refs.modalStockWriteOffVue.id=e},async getByTitle(){let e=await this.service.getByTitlePaged(this.searchText,this.pageId,this.findAssets);this.itens=e.content,this.$refs.nextPageTable.totalPages=e.totalPages,this.$refs.nextPageTable.totalElements=e.totalElements,this.$refs.nextPageTable.pageable.pageNumber=e.pageable.pageNumber},async consultaTodos(){let e=await this.service.getAllPaged(this.pageId,this.findAssets);this.itens=e.content,this.$refs.nextPageTable.totalPages=e.totalPages,this.$refs.nextPageTable.totalElements=e.totalElements,this.$refs.nextPageTable.pageable.pageNumber=e.pageable.pageNumber},async excluir(){if(this.modalExcluir=!1,console.log(this.idItem),void 0!=this.idItem){let e=await this.service.excluir(this.idItem);204==e.status?(this.$refs.toast.createToast("Excluído com sucesso!"),this.consultaTodos()):this.$refs.toast.createToast("Ocorreu um erro ao excluir item!")}},refreshList(){console.log("Aqui!"),this.consultaTodos()},alterar(e){this.$router.push({path:`/forms/produto/cadastro/${e}`})},updatePageId(e){this.pageId=e,this.consultaTodos()}},computed:{},mounted(){this.consultaTodos()}},L=(0,O.Z)(E,[["render",h],["__scopeId","data-v-6bc9796f"]]),M=L}}]);
//# sourceMappingURL=320.7d350e90.js.map